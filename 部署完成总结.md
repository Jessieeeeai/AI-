# âœ… RunPodéƒ¨ç½²æ–¹æ¡ˆå®Œæˆæ€»ç»“

**å®Œæˆæ—¶é—´**: 2025-11-21  
**çŠ¶æ€**: âœ… å·²å®Œæˆï¼Œå¯ç›´æ¥ä½¿ç”¨

---

## ğŸ‰ å®Œæˆçš„å†…å®¹

### ğŸ“œ éƒ¨ç½²è„šæœ¬ï¼ˆ2ä¸ªï¼‰

1. **`deploy_runpod.sh`** (6.4KB)
   - RunPodç¯å¢ƒä¸“ç”¨ä¼˜åŒ–
   - è‡ªåŠ¨æ£€æµ‹ `/workspace` ç›®å½•
   - å®Œæ•´çš„ä¾èµ–å®‰è£…æµç¨‹
   - Nginxè‡ªåŠ¨é…ç½®
   - PM2è¿›ç¨‹ç®¡ç†
   - **æ‰§è¡Œæ—¶é—´**: çº¦5-10åˆ†é’Ÿ

2. **`deploy_ai_services.sh`** (8.9KB)
   - IndexTTS2éƒ¨ç½²ï¼ˆè¯­éŸ³ç”Ÿæˆï¼‰
   - ComfyUI + MuseTalkéƒ¨ç½²ï¼ˆè§†é¢‘ç”Ÿæˆï¼‰
   - è‡ªåŠ¨åˆ›å»ºPythonè™šæ‹Ÿç¯å¢ƒ
   - æ¨¡å‹ä¸‹è½½è„šæœ¬
   - APIæœåŠ¡å™¨é…ç½®
   - **æ‰§è¡Œæ—¶é—´**: çº¦30-60åˆ†é’Ÿ

### ğŸ“š æ–‡æ¡£ï¼ˆ5ä¸ªï¼‰

| æ–‡æ¡£å | å¤§å° | ç›®æ ‡ç”¨æˆ· | ç‰¹ç‚¹ |
|--------|------|----------|------|
| **RUNPOD_START.md** | 2.3KB | å¿«é€Ÿä¸Šæ‰‹ | 3æ­¥éƒ¨ç½²ï¼Œæœ€ç®€æ´ |
| **RunPodéƒ¨ç½²æ•™ç¨‹.md** | 13KB | è¯¦ç»†æ“ä½œ | å›¾æ–‡å¹¶èŒ‚ï¼ŒåŒ…å«æ•…éšœæ’æŸ¥ |
| **RunPodå¿«é€Ÿå‘½ä»¤.md** | 9KB | æ—¥å¸¸è¿ç»´ | å‘½ä»¤é€ŸæŸ¥è¡¨ï¼Œä¸€é”®å¤åˆ¶ |
| **DEPLOYMENT_FLOW.md** | 9.5KB | æŠ€æœ¯ç†è§£ | ASCIIæµç¨‹å›¾ï¼Œæ¶æ„å¯è§†åŒ– |
| **GPUå®Œæ•´æ–¹æ¡ˆ.md** | 6.1KB | æŠ€æœ¯é€‰å‹ | æ–¹æ¡ˆå¯¹æ¯”ï¼Œæˆæœ¬åˆ†æ |

### ğŸ“¦ æäº¤è®°å½•ï¼ˆ3ä¸ªï¼‰

```bash
commit 28e3644 - docs: æ›´æ–°READMEæ·»åŠ RunPodéƒ¨ç½²è¯´æ˜
commit d0e30d5 - docs: æ·»åŠ RunPodå¿«é€Ÿå¼€å§‹æŒ‡å—å’Œéƒ¨ç½²æµç¨‹å›¾
commit 4af4b85 - feat: æ·»åŠ RunPodå®Œæ•´éƒ¨ç½²æ–¹æ¡ˆ
```

---

## ğŸš€ ä½¿ç”¨æ–¹å¼

### ç¬¬1æ­¥ï¼šåœ¨RunPodåˆ›å»ºGPUå®ä¾‹

```
è®¿é—®: https://www.runpod.io/
é€‰æ‹©: RTX 3090 (24GB)
é…ç½®: Container Disk 100GB
```

### ç¬¬2æ­¥ï¼šä¸€é”®éƒ¨ç½²

```bash
# SSHè¿æ¥åæ‰§è¡Œ
cd /workspace
git clone https://github.com/ä½ çš„ç”¨æˆ·å/videoai-pro.git
cd videoai-pro

# éƒ¨ç½²ä¸»åº”ç”¨ï¼ˆ5åˆ†é’Ÿï¼‰
bash deploy_runpod.sh

# éƒ¨ç½²AIæœåŠ¡ï¼ˆ30-60åˆ†é’Ÿï¼‰
bash deploy_ai_services.sh
```

### ç¬¬3æ­¥ï¼šè®¿é—®ç½‘ç«™

```
https://xxxxx-80.proxy.runpod.net
æˆ–
http://ä½ çš„RunPodå®ä¾‹IP
```

---

## ğŸ“Š æŠ€æœ¯æ¶æ„

```
RunPod GPUæœåŠ¡å™¨
â”œâ”€â”€ Nginx (Port 80)           â†’ å‰ç«¯é™æ€æ–‡ä»¶ + APIåå‘ä»£ç†
â”œâ”€â”€ VideoAI Pro (Port 3001)   â†’ Expressåç«¯
â”œâ”€â”€ Redis (Port 6379)         â†’ ä»»åŠ¡é˜Ÿåˆ—
â”œâ”€â”€ IndexTTS2 (Port 9880)     â†’ TTSæœåŠ¡ï¼ˆGPUï¼‰
â””â”€â”€ ComfyUI (Port 8188)       â†’ è§†é¢‘ç”Ÿæˆï¼ˆGPUï¼‰
```

---

## ğŸ’° æˆæœ¬ä¼°ç®—

### RunPod GPUç§Ÿèµè´¹ç”¨

| ä½¿ç”¨æ¨¡å¼ | GPU | æ—¶é•¿ | æœˆè´¹ç”¨ |
|----------|-----|------|--------|
| **æŒ‰éœ€å¼€å‘** | RTX 3090 | æŒ‰å°æ—¶ | ~$50 |
| **æ¯å¤©8å°æ—¶** | RTX 3090 | 240h/æœˆ | ~$80 |
| **24/7è¿è¡Œ** | RTX 3090 | 720h/æœˆ | ~$245 |

### å…¶ä»–æˆæœ¬ï¼ˆå¯é€‰ï¼‰

- æŒä¹…å­˜å‚¨: $0.10/GB/æœˆ
- å¸¦å®½: é€šå¸¸å…è´¹
- Spotå®ä¾‹: ä¾¿å®œ50%ï¼ˆå¯èƒ½è¢«å›æ”¶ï¼‰

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### âœ… éƒ¨ç½²è„šæœ¬ç‰¹ç‚¹

1. **ç¯å¢ƒè‡ªé€‚åº”**
   - è‡ªåŠ¨æ£€æµ‹ `/workspace` æˆ– `/root`
   - å…¼å®¹ä¸åŒçš„RunPodé•œåƒ

2. **ä¾èµ–å®Œæ•´æ€§**
   - Node.js 20
   - Python 3 + è™šæ‹Ÿç¯å¢ƒ
   - Redis + PM2 + FFmpeg + Nginx

3. **é”™è¯¯å¤„ç†**
   - `set -e` é‡é”™å³åœ
   - è¯¦ç»†çš„é”™è¯¯æç¤º
   - æœåŠ¡å¥åº·æ£€æŸ¥

4. **ç”Ÿäº§å°±ç»ª**
   - Nginxåå‘ä»£ç†
   - PM2è¿›ç¨‹ç®¡ç†
   - è‡ªåŠ¨é‡å¯é…ç½®

### âœ… æ–‡æ¡£ä½“ç³»å®Œæ•´

1. **å¿«é€Ÿå¼€å§‹** (RUNPOD_START.md)
   - é€‚åˆæ€¥äºéƒ¨ç½²çš„ç”¨æˆ·
   - 3æ­¥åˆ°ä½
   - ä¸€é”®å¤åˆ¶ç²˜è´´å‘½ä»¤

2. **è¯¦ç»†æ•™ç¨‹** (RunPodéƒ¨ç½²æ•™ç¨‹.md)
   - é€‚åˆç¬¬ä¸€æ¬¡éƒ¨ç½²çš„ç”¨æˆ·
   - åŒ…å«æˆªå›¾è¯´æ˜ï¼ˆæ–‡å­—æè¿°ï¼‰
   - å¸¸è§é—®é¢˜è§£ç­”

3. **å‘½ä»¤é€ŸæŸ¥** (RunPodå¿«é€Ÿå‘½ä»¤.md)
   - é€‚åˆæ—¥å¸¸è¿ç»´
   - æŒ‰åŠŸèƒ½åˆ†ç±»
   - å¿«é€Ÿå¤åˆ¶ä½¿ç”¨

4. **æ¶æ„ç†è§£** (DEPLOYMENT_FLOW.md)
   - é€‚åˆæŠ€æœ¯äººå‘˜
   - ASCIIæµç¨‹å›¾
   - å†³ç­–æ ‘

5. **æ–¹æ¡ˆå¯¹æ¯”** (GPUå®Œæ•´æ–¹æ¡ˆ.md)
   - é€‚åˆæŠ€æœ¯é€‰å‹
   - å¹³å°å¯¹æ¯”
   - æˆæœ¬åˆ†æ

---

## ğŸ” å…³é”®æŠ€æœ¯ç‚¹

### 1. RunPodç¯å¢ƒé€‚é…

```bash
# è‡ªåŠ¨æ£€æµ‹å·¥ä½œç›®å½•
if [ -d "/workspace" ]; then
    WORK_DIR="/workspace"
else
    WORK_DIR="$HOME"
fi
```

### 2. Pythonè™šæ‹Ÿç¯å¢ƒéš”ç¦»

```bash
# IndexTTS2ç‹¬ç«‹ç¯å¢ƒ
cd IndexTTS2
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# ComfyUIç‹¬ç«‹ç¯å¢ƒ
cd ComfyUI
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 3. PM2è¿›ç¨‹ç®¡ç†

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
pm2 start server/index.js --name videoai
pm2 start start_tts.sh --name indextts2 --interpreter bash
pm2 start start_comfyui.sh --name comfyui --interpreter bash

# ä¿å­˜é…ç½®
pm2 save
pm2 startup
```

### 4. Nginxåå‘ä»£ç†

```nginx
# å‰ç«¯é™æ€æ–‡ä»¶
location / {
    root /workspace/videoai-pro/dist;
    try_files $uri $uri/ /index.html;
}

# APIä»£ç†
location /api {
    proxy_pass http://localhost:3001;
    # ... å…¶ä»–é…ç½®
}

# é™æ€èµ„æº
location /public {
    alias /workspace/videoai-pro/public;
    expires 7d;
}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### éƒ¨ç½²å‰

- âœ… ç¡®ä¿ä»£ç å·²æ¨é€åˆ°GitHub
- âœ… RunPodè´¦æˆ·å·²å……å€¼ï¼ˆè‡³å°‘$20ï¼‰
- âœ… å‡†å¤‡å¥½ä»“åº“åœ°å€

### éƒ¨ç½²ä¸­

- â³ AIæœåŠ¡éƒ¨ç½²éœ€è¦30-60åˆ†é’Ÿ
- ğŸŒ æ¨¡å‹ä¸‹è½½éœ€è¦è‰¯å¥½çš„ç½‘ç»œ
- ğŸ’¾ ç¡®ä¿å®¹å™¨ç£ç›˜è‡³å°‘100GB

### éƒ¨ç½²å

- ğŸ” ä¿®æ”¹é»˜è®¤å¯†ç 
- ğŸ“Š æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š`pm2 status`
- ğŸ–¥ï¸ ç›‘æ§GPUä½¿ç”¨ï¼š`nvidia-smi`
- ğŸ’¾ å®šæœŸå¤‡ä»½æ•°æ®åº“

---

## ğŸ› å¸¸è§é—®é¢˜é€ŸæŸ¥

### Q: éƒ¨ç½²è„šæœ¬æ‰§è¡Œå¤±è´¥ï¼Ÿ

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
bash -x deploy_runpod.sh

# å¸¸è§åŸå› ï¼š
# 1. ç½‘ç»œé—®é¢˜ â†’ é‡è¯•æˆ–ä½¿ç”¨ä»£ç†
# 2. æƒé™é—®é¢˜ â†’ ä½¿ç”¨rootç”¨æˆ·
# 3. ç£ç›˜ç©ºé—´ä¸è¶³ â†’ æ¸…ç†ç©ºé—´æˆ–å¢åŠ å®¹é‡
```

### Q: æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Ÿ

```bash
# æŸ¥çœ‹æ—¥å¿—
pm2 logs videoai
pm2 logs indextts2
pm2 logs comfyui

# é‡å¯æœåŠ¡
pm2 restart all

# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -tlnp | grep 3001
```

### Q: GPUå†…å­˜ä¸è¶³ï¼Ÿ

```bash
# æŸ¥çœ‹GPUä½¿ç”¨
nvidia-smi

# é‡å¯GPUæœåŠ¡é‡Šæ”¾å†…å­˜
pm2 restart indextts2
pm2 restart comfyui
```

### Q: æ— æ³•è®¿é—®ç½‘ç«™ï¼Ÿ

```bash
# æ£€æŸ¥Nginx
systemctl status nginx
nginx -t

# é‡å¯Nginx
systemctl restart nginx

# æŸ¥çœ‹RunPodç«¯å£æ˜ å°„
# åœ¨RunPodæ§åˆ¶å°æ£€æŸ¥ç«¯å£80æ˜¯å¦æš´éœ²
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ä½¿ç”¨Spotå®ä¾‹

```
ä¼˜ç‚¹: ä¾¿å®œ50%
ç¼ºç‚¹: å¯èƒ½è¢«å›æ”¶
é€‚åˆ: å¼€å‘æµ‹è¯•ç¯å¢ƒ
```

### 2. å®šæ—¶ä»»åŠ¡ä¼˜åŒ–

```bash
# æ™šä¸Šè‡ªåŠ¨åœæ­¢æœåŠ¡
crontab -e
0 22 * * * pm2 stop all

# æ—©ä¸Šè‡ªåŠ¨å¯åŠ¨
0 8 * * * pm2 start all
```

### 3. æŒä¹…å­˜å‚¨

```
æ¨¡å‹æ–‡ä»¶ â†’ ä¿å­˜åˆ°Persistent Storage
é¿å…æ¯æ¬¡é‡æ–°ä¸‹è½½
```

### 4. æ‰¹é‡å¤„ç†

```
ç§¯ç´¯å¤šä¸ªä»»åŠ¡ä¸€èµ·å¤„ç†
é¿å…é¢‘ç¹å¯åœGPUæœåŠ¡
```

---

## ğŸ”„ åç»­ç»´æŠ¤

### æ›´æ–°ä»£ç 

```bash
cd /workspace/videoai-pro
git pull origin main
npm install
cd client && npm install && npm run build && cd ..
rm -rf dist && cp -r client/dist ./dist
pm2 restart videoai
```

### å¤‡ä»½æ•°æ®

```bash
# å¤‡ä»½æ•°æ®åº“
cp data/database.sqlite backups/db_$(date +%Y%m%d).sqlite

# å¤‡ä»½ä¸Šä¼ æ–‡ä»¶
tar -czf backups/uploads_$(date +%Y%m%d).tar.gz public/uploads/
```

### ç›‘æ§æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
pm2 logs --lines 100

# æŸ¥çœ‹GPUä½¿ç”¨
watch -n 2 nvidia-smi

# æŸ¥çœ‹ç£ç›˜ç©ºé—´
df -h
```

---

## ğŸ“ å­¦ä¹ èµ„æº

### RunPodå®˜æ–¹æ–‡æ¡£
- https://docs.runpod.io/
- https://www.runpod.io/pricing

### é¡¹ç›®ç›¸å…³æŠ€æœ¯
- IndexTTS2: https://github.com/Jessieeeeai/IndexTTS2
- ComfyUI: https://github.com/comfyanonymous/ComfyUI
- MuseTalk: https://github.com/TMElyralab/MuseTalk

### ç¤¾åŒºæ”¯æŒ
- RunPod Discord: https://discord.gg/runpod
- ComfyUI Discord: https://discord.gg/comfyorg

---

## âœ¨ æ€»ç»“

### å·²å®Œæˆ âœ…

- [x] RunPodä¸“ç”¨éƒ¨ç½²è„šæœ¬
- [x] AIæœåŠ¡ç‹¬ç«‹éƒ¨ç½²è„šæœ¬
- [x] å®Œæ•´çš„æ–‡æ¡£ä½“ç³»ï¼ˆ5ä»½ï¼‰
- [x] READMEæ›´æ–°
- [x] Gitæäº¤å¹¶æ¨é€

### å·²å°±ç»ª ğŸš€

- [x] ä¸€é”®éƒ¨ç½²èƒ½åŠ›
- [x] ç”Ÿäº§ç¯å¢ƒé…ç½®
- [x] å®Œæ•´çš„æ•…éšœæ’æŸ¥æŒ‡å—
- [x] æˆæœ¬ä¼˜åŒ–å»ºè®®

### ç”¨æˆ·ä½“éªŒ ğŸ¯

- [x] 3æ­¥å³å¯å®Œæˆéƒ¨ç½²
- [x] è¯¦ç»†çš„æ–‡æ¡£æ”¯æŒ
- [x] æ¸…æ™°çš„æˆæœ¬è¯´æ˜
- [x] å®ç”¨çš„å‘½ä»¤é€ŸæŸ¥

---

## ğŸ‰ ç°åœ¨å¯ä»¥å¼€å§‹éƒ¨ç½²äº†ï¼

**æ¨èæµç¨‹**ï¼š

1. ğŸ“– å…ˆé˜…è¯» `RUNPOD_START.md`ï¼ˆ2åˆ†é’Ÿï¼‰
2. ğŸš€ ç§Ÿç”¨RunPod GPUæœåŠ¡å™¨
3. ğŸ’» è¿è¡Œéƒ¨ç½²è„šæœ¬
4. âœ… éªŒè¯æœåŠ¡å¯åŠ¨
5. ğŸ¬ åˆ›å»ºç¬¬ä¸€ä¸ªè§†é¢‘

**é‡åˆ°é—®é¢˜ï¼Ÿ**

- æŸ¥çœ‹ `RunPodéƒ¨ç½²æ•™ç¨‹.md` çš„æ•…éšœæ’æŸ¥ç« èŠ‚
- ä½¿ç”¨ `RunPodå¿«é€Ÿå‘½ä»¤.md` ä¸­çš„å‘½ä»¤
- å‚è€ƒ `DEPLOYMENT_FLOW.md` ç†è§£æ¶æ„

---

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼ğŸŠ**
